{"source":"https:\/\/excalidraw.com","elements":[{"opacity":100,"x":623,"text":"Ride Sharing App","fillStyle":"solid","type":"text","lineHeight":1.25,"originalText":"Ride Sharing App","updated":1756998130647,"groupIds":[],"strokeStyle":"solid","seed":2101326261,"strokeWidth":2,"angle":0,"locked":false,"textAlign":"left","verticalAlign":"top","fontSize":36,"backgroundColor":"transparent","fontFamily":8,"width":316.79998779296875,"strokeColor":"#1e1e1e","y":150,"index":"a0","id":"K85YS_yJFHHEu1ebvUKYj","version":26,"isDeleted":false,"versionNonce":984183739,"height":45,"autoResize":true,"roughness":1},{"opacity":100,"x":287,"text":"Fare Estimation\n\n- User enters source and destination on the app.\n- Then clicks then button get the estimate.\n- On click of button app initiates an API call\n  GET \/api\/v1\/fare-estimation\n  { source:{lat,long}, destination:{lat,long} }\n\n- The request then lands on the API Gateway and and forwaded to the \n  Ride service.\n\n- Ride service will first connect with third party geospatial providers like\n  Google Directions API to fetch optimal route between the source and destination.\n- This third party providers will takes real-time traffic, one-way roads, road closures,\n  tolls into account and provides optimal route.\n- This providers returns distance in km\/miles and estimated time.\n\n- Then ride service will calculates fare based on distance and time and returns it to the user.\n","fillStyle":"solid","type":"text","lineHeight":1.25,"originalText":"Fare Estimation\n\n- User enters source and destination on the app.\n- Then clicks then button get the estimate.\n- On click of button app initiates an API call\n  GET \/api\/v1\/fare-estimation\n  { source:{lat,long}, destination:{lat,long} }\n\n- The request then lands on the API Gateway and and forwaded to the \n  Ride service.\n\n- Ride service will first connect with third party geospatial providers like\n  Google Directions API to fetch optimal route between the source and destination.\n- This third party providers will takes real-time traffic, one-way roads, road closures,\n  tolls into account and provides optimal route.\n- This providers returns distance in km\/miles and estimated time.\n\n- Then ride service will calculates fare based on distance and time and returns it to the user.\n","updated":1757001798241,"groupIds":[],"strokeStyle":"solid","seed":84950587,"strokeWidth":2,"angle":0,"locked":false,"textAlign":"left","verticalAlign":"top","fontSize":20,"backgroundColor":"transparent","fontFamily":8,"width":1045,"strokeColor":"#1e1e1e","y":1795,"index":"a1","id":"roJ2EzzQ0LEMuHjwBVaCg","version":867,"isDeleted":false,"versionNonce":1762282939,"height":475,"autoResize":true,"roughness":1},{"index":"a2","backgroundColor":"transparent","roundness":{"type":3},"fillStyle":"solid","width":131,"versionNonce":1175721499,"version":73,"isDeleted":false,"boundElements":[{"id":"hRpBXPSnxdDaes4VT_G9z","type":"text"},{"id":"kJCheticmnGZCCUr-h8ky","type":"arrow"}],"groupIds":[],"updated":1757005128160,"roughness":1,"opacity":100,"id":"36MJXY-wkDhtZy3Pl3AES","angle":0,"strokeStyle":"solid","strokeColor":"#1e1e1e","y":1851.85531499032,"x":2066.830945537876,"locked":false,"seed":159872597,"height":90,"type":"rectangle","strokeWidth":2},{"opacity":100,"x":2099.330945537876,"text":"Rider\nClient","fillStyle":"solid","type":"text","lineHeight":1.25,"originalText":"Rider Client","updated":1757005119251,"groupIds":[],"strokeStyle":"solid","seed":1403405435,"strokeWidth":2,"angle":0,"locked":false,"textAlign":"center","containerId":"36MJXY-wkDhtZy3Pl3AES","verticalAlign":"middle","fontSize":20,"backgroundColor":"transparent","fontFamily":8,"width":66,"strokeColor":"#1e1e1e","y":1871.85531499032,"index":"a3","id":"hRpBXPSnxdDaes4VT_G9z","version":56,"isDeleted":false,"versionNonce":639057877,"height":50,"autoResize":true,"roughness":1},{"index":"a4","backgroundColor":"transparent","roundness":{"type":3},"fillStyle":"solid","width":189,"versionNonce":288514517,"version":56,"isDeleted":false,"boundElements":[{"id":"O0z1j9cgb8DnJwI7-XtEB","type":"text"},{"id":"kJCheticmnGZCCUr-h8ky","type":"arrow"},{"id":"TJHjPT196us5q3Yh08wqX","type":"arrow"}],"groupIds":[],"updated":1757005238402,"roughness":1,"opacity":100,"id":"mDCs74eTJYPR0NzywK7eO","angle":0,"strokeStyle":"solid","strokeColor":"#1e1e1e","y":1776.85531499032,"x":2447.830945537876,"locked":false,"seed":471984955,"height":382,"type":"rectangle","strokeWidth":2},{"opacity":100,"x":2481.830945537876,"text":"API Gateway","fillStyle":"solid","type":"text","lineHeight":1.25,"originalText":"API Gateway","updated":1757005114514,"groupIds":[],"strokeStyle":"solid","seed":1128024507,"strokeWidth":2,"angle":0,"locked":false,"textAlign":"center","containerId":"mDCs74eTJYPR0NzywK7eO","verticalAlign":"middle","fontSize":20,"backgroundColor":"transparent","fontFamily":8,"width":121,"strokeColor":"#1e1e1e","y":1955.35531499032,"index":"a4V","id":"O0z1j9cgb8DnJwI7-XtEB","version":13,"isDeleted":false,"versionNonce":723061211,"height":25,"autoResize":true,"roughness":1},{"opacity":100,"x":2213.830945537876,"elbowed":false,"fillStyle":"solid","boundElements":[],"type":"arrow","startBinding":{"elementId":"36MJXY-wkDhtZy3Pl3AES","gap":16.373251759376757,"focus":-0.6065020702346269},"updated":1757005128921,"groupIds":[],"strokeStyle":"solid","seed":595497275,"strokeWidth":2,"angle":0,"locked":false,"backgroundColor":"transparent","y":1867.85531499032,"width":213,"strokeColor":"#1e1e1e","index":"a6","id":"kJCheticmnGZCCUr-h8ky","endArrowhead":"arrow","roundness":{"type":2},"version":53,"isDeleted":false,"endBinding":{"elementId":"mDCs74eTJYPR0NzywK7eO","gap":21,"focus":0.5439932627878872},"versionNonce":699011707,"height":3,"points":[[0,0],[213,-3]],"roughness":1},{"index":"a8","backgroundColor":"transparent","roundness":{"type":3},"fillStyle":"solid","width":283,"versionNonce":1221901653,"version":167,"isDeleted":false,"boundElements":[{"id":"hTvIpzCTLdi0zPhPz0fTY","type":"text"},{"id":"fokmRrk7XrQmZRsRkDRpa","type":"arrow"},{"id":"TJHjPT196us5q3Yh08wqX","type":"arrow"},{"id":"oR7Z1HabD8CfPz0CC12an","type":"arrow"}],"groupIds":[],"updated":1757005282330,"roughness":1,"opacity":100,"id":"ffhalFOwR7gpTruAmKZfG","angle":0,"strokeStyle":"solid","strokeColor":"#1e1e1e","y":1809.85531499032,"x":2895.830945537876,"locked":false,"seed":2042511451,"height":110,"type":"rectangle","strokeWidth":2},{"opacity":100,"x":2971.330945537876,"text":"Ride Service","fillStyle":"solid","type":"text","lineHeight":1.25,"originalText":"Ride Service","updated":1757005230809,"groupIds":[],"strokeStyle":"solid","seed":1862380949,"strokeWidth":2,"angle":0,"locked":false,"textAlign":"center","containerId":"ffhalFOwR7gpTruAmKZfG","verticalAlign":"middle","fontSize":20,"backgroundColor":"transparent","fontFamily":8,"width":132,"strokeColor":"#1e1e1e","y":1852.35531499032,"index":"a9","id":"hTvIpzCTLdi0zPhPz0fTY","version":55,"isDeleted":false,"versionNonce":660525467,"height":25,"autoResize":true,"roughness":1},{"index":"aA","backgroundColor":"transparent","roundness":{"type":2},"fillStyle":"solid","width":221.00000000000023,"versionNonce":591744501,"version":555,"isDeleted":false,"boundElements":[{"id":"9nBnQxYepeS7B_4-uwtnG","type":"text"},{"id":"fokmRrk7XrQmZRsRkDRpa","type":"arrow"}],"groupIds":[],"updated":1757005217683,"roughness":1,"opacity":100,"id":"tzRPpEXZ_A0bgoLT3pD6m","angle":0,"strokeStyle":"solid","strokeColor":"#1e1e1e","y":1452.85531499032,"x":2893.830945537876,"locked":false,"seed":920032955,"height":139,"type":"diamond","strokeWidth":2},{"opacity":100,"x":2955.080945537876,"text":"3rd party\nproviders","fillStyle":"solid","type":"text","lineHeight":1.25,"originalText":"3rd party\nproviders","updated":1757005211486,"groupIds":[],"strokeStyle":"solid","seed":313171707,"strokeWidth":2,"angle":0,"locked":false,"textAlign":"center","containerId":"tzRPpEXZ_A0bgoLT3pD6m","verticalAlign":"middle","fontSize":20,"backgroundColor":"transparent","fontFamily":8,"width":99,"strokeColor":"#1e1e1e","y":1497.60531499032,"index":"aAV","id":"9nBnQxYepeS7B_4-uwtnG","version":229,"isDeleted":false,"versionNonce":259313083,"height":50,"autoResize":true,"roughness":1},{"opacity":100,"x":3011.780743184069,"elbowed":false,"fillStyle":"solid","boundElements":[],"type":"arrow","startBinding":{"elementId":"ffhalFOwR7gpTruAmKZfG","gap":25,"focus":-0.16947484934202303},"updated":1757005230809,"groupIds":[],"strokeStyle":"solid","seed":843242235,"strokeWidth":2,"angle":0,"locked":false,"backgroundColor":"transparent","y":1784.85531499032,"width":3.1278882900596727,"strokeColor":"#1e1e1e","index":"aD","id":"fokmRrk7XrQmZRsRkDRpa","endArrowhead":"arrow","roundness":{"type":2},"version":117,"isDeleted":false,"endBinding":{"elementId":"tzRPpEXZ_A0bgoLT3pD6m","gap":19.4306591707117,"focus":-0.028902459427797157},"versionNonce":1818748475,"height":178.14741049083386,"points":[[0,0],[-3.1278882900596727,-178.14741049083386]],"roughness":1},{"opacity":100,"x":2663.830945537876,"elbowed":false,"fillStyle":"solid","boundElements":[],"type":"arrow","startBinding":{"elementId":"mDCs74eTJYPR0NzywK7eO","gap":27,"focus":-0.7275371082740282},"updated":1757005239199,"groupIds":[],"strokeStyle":"solid","seed":1185534843,"strokeWidth":2,"angle":0,"locked":false,"backgroundColor":"transparent","y":1829.9150073731325,"width":207,"strokeColor":"#1e1e1e","index":"aF","id":"TJHjPT196us5q3Yh08wqX","endArrowhead":"arrow","roundness":{"type":2},"version":70,"isDeleted":false,"endBinding":{"elementId":"ffhalFOwR7gpTruAmKZfG","gap":25.076151887215993,"focus":0.4801810456662816},"versionNonce":301970293,"height":4,"points":[[0,0],[207,4]],"roughness":1},{"index":"aH","backgroundColor":"#228be6","width":101.43255738417912,"fillStyle":"solid","versionNonce":1601014837,"boundElements":[],"version":2705,"isDeleted":false,"updated":1757005285885,"groupIds":["rTHNFNDA7pXXB0N2T1f4J","puEzt2iwecZ6wtg19jXKU"],"roughness":1,"opacity":100,"id":"uIPOZA44pBRxyCq-fMM2_","angle":0,"strokeStyle":"solid","strokeColor":"#364fc7","y":1841.6171412192548,"x":3414.3906297921276,"locked":false,"seed":582807835,"points":[[0,0],[0,81.24504586319145],[1.777062999357842,95.93711004248823],[13.975545169118597,101.33520266828153],[32.24595007890858,105.6036749382846],[51.72898522706211,106.7059820442988],[68.36290060874084,105.6069084227593],[83.9642241791822,102.88989158362904],[99.52537188642827,95.35807376427104],[100.58910440204657,81.24504586319145],[101.43255738417912,11.066502392818677],[100.15182896713623,-0.353787502790162],[87.54390769820083,-6.446029372429869],[73.39395832349102,-9.897171202621365],[54.99841378339567,-10.91127596339463],[43.322977231062616,-10.881763683096402],[18.460883213902022,-8.686704925433872],[0,0]],"height":117.61725800769344,"type":"line","strokeWidth":1},{"index":"aI","backgroundColor":"#ffffff","width":101.25296680383022,"fillStyle":"solid","versionNonce":1924677013,"boundElements":[{"id":"oR7Z1HabD8CfPz0CC12an","type":"arrow"}],"version":958,"isDeleted":false,"updated":1757005285885,"groupIds":["rTHNFNDA7pXXB0N2T1f4J","puEzt2iwecZ6wtg19jXKU"],"roughness":1,"opacity":100,"id":"ghykcw13XxJjS_BcJ2Tc8","angle":0,"strokeStyle":"solid","strokeColor":"#364fc7","y":1829.2922871916103,"x":3414.017167514852,"locked":false,"seed":634787259,"height":27.53016315242473,"type":"ellipse","strokeWidth":1},{"opacity":100,"x":3416.01239451702,"text":"Database","fillStyle":"hachure","boundElements":[],"type":"text","originalText":"Database","lineHeight":1.25,"updated":1757005285887,"groupIds":["X1bXUswCKv-ENCdN6uqXZ","puEzt2iwecZ6wtg19jXKU"],"strokeStyle":"solid","seed":2141300315,"strokeWidth":2,"angle":0,"locked":false,"textAlign":"center","verticalAlign":"top","fontSize":20,"backgroundColor":"#228be6","y":1949.2922871916103,"width":99,"strokeColor":"#000000","fontFamily":1,"index":"aJ","id":"EUAstzivi0gEHD-LDbsxo","version":177,"isDeleted":false,"versionNonce":1023122517,"height":25,"autoResize":true,"roughness":1},{"opacity":100,"x":3203.7917842814186,"elbowed":false,"fillStyle":"solid","boundElements":[],"type":"arrow","startBinding":{"gap":25.303985921194254,"elementId":"ffhalFOwR7gpTruAmKZfG","focus":-0.6677534105248357},"updated":1757005285887,"groupIds":[],"strokeStyle":"solid","seed":1173526325,"strokeWidth":2,"angle":0,"locked":false,"backgroundColor":"transparent","y":1830.1625043585973,"width":202.87131785135352,"strokeColor":"#1e1e1e","index":"aK","id":"oR7Z1HabD8CfPz0CC12an","endArrowhead":"arrow","roundness":{"type":2},"version":75,"isDeleted":false,"endBinding":{"gap":9.500049230851653,"elementId":"ghykcw13XxJjS_BcJ2Tc8","focus":0.2630161920485297},"versionNonce":543539957,"height":6.734725119999894,"points":[[0,0],[202.87131785135352,6.734725119999894]],"roughness":1},{"opacity":100,"x":3572.666855753342,"text":"Fare\n- id\n- userId\n- source\n- destination\n- distanceInKm\n- eta\n- …metadata\n","fillStyle":"solid","type":"text","lineHeight":1.25,"originalText":"Fare\n- id\n- userId\n- source\n- destination\n- distanceInKm\n- eta\n- …metadata\n","updated":1757005336471,"groupIds":[],"strokeStyle":"solid","seed":521543797,"strokeWidth":2,"angle":0,"locked":false,"textAlign":"left","verticalAlign":"top","fontSize":20,"backgroundColor":"transparent","fontFamily":8,"width":154,"strokeColor":"#1e1e1e","y":1817.0700717882883,"index":"aM","id":"5bO1XiFVLM5HtzHrfqGCl","version":96,"isDeleted":false,"versionNonce":1483036859,"height":225,"autoResize":true,"roughness":1},{"opacity":100,"x":271.2343142471524,"text":"Ride confirmation\n\n- After fare returned to the client, proceeds with the ride.\n\n- Request is forwarded to the Ride service.\n- Ride service accepts this request and creates a new entry in the ride table with\n  - Ride ( id, riderId, driverId(nullable — matched later), source, destination, distance, eta, \n           status (driverRequested|driverMatched|driverConfirmed|rideStarted|rideEnded))\n- puts a new message in the message queue with rideId\n- returns ride details back to the UI.\n- UI will show finding drivers to the rider.\n\n- Driver Matching worker will consume this event\/message from the queue and finds driver near by.\n\n- To find the drivers nearby we need to capture drivers location periodically. \n\n- Drivers will have a dedicated app to send location updates, accept\/decline rides.\n- When driver logs into the app and makes themselves available to accept rides (online status)\n  drivers client app sends location coordinates periodically.\n- These location coordinates are forwarded to Location Service and Added in the location database.\n- This database needs to be supporting high throughput because each drivers will send their location\n    coordinates evey 10-20 seconds periodically. Database should support high tps. \n- Also this database should support effective queries to find drivers nearby.\n- Few Relational databases support this but has thier own drawbacks interms of scaling and querying.\n- One option we can go ahead with is Redis GeoHashing.\n- We can store drivers location coordinates in the redis.\n- We will also store whether drivers is online or not in the redis.\n\n- Driver matching worker will query this redis database with source coordinates and fetched nearby 10-20 drivers.\n- Then these drivers list is stored in the redis with rideId->drivers.\n\n- Driver matching service will iterate through the drivers and\n- fetch status of driver from redis (to know whether any request already sent to driver or driver in ride)\n- If driver is free then we send a notification to the driver about the ride\n  (websocket, server sent event or push notifications)\n- We also update driver status in redis to rideRequestSent so that other ride requests do not send same event to the driver.\n\n- If driver accepts the request then we update the ride status as well as driver status.\n- If the driver declines it then we move on to the other driver.\n\n- Meanwhile rider app will keep on polling the ride service and check whether any driver matched or not.\n","fillStyle":"solid","type":"text","lineHeight":1.25,"originalText":"Ride confirmation\n\n- After fare returned to the client, proceeds with the ride.\n\n- Request is forwarded to the Ride service.\n- Ride service accepts this request and creates a new entry in the ride table with\n  - Ride ( id, riderId, driverId(nullable — matched later), source, destination, distance, eta, \n           status (driverRequested|driverMatched|driverConfirmed|rideStarted|rideEnded))\n- puts a new message in the message queue with rideId\n- returns ride details back to the UI.\n- UI will show finding drivers to the rider.\n\n- Driver Matching worker will consume this event\/message from the queue and finds driver near by.\n\n- To find the drivers nearby we need to capture drivers location periodically. \n\n- Drivers will have a dedicated app to send location updates, accept\/decline rides.\n- When driver logs into the app and makes themselves available to accept rides (online status)\n  drivers client app sends location coordinates periodically.\n- These location coordinates are forwarded to Location Service and Added in the location database.\n- This database needs to be supporting high throughput because each drivers will send their location\n    coordinates evey 10-20 seconds periodically. Database should support high tps. \n- Also this database should support effective queries to find drivers nearby.\n- Few Relational databases support this but has thier own drawbacks interms of scaling and querying.\n- One option we can go ahead with is Redis GeoHashing.\n- We can store drivers location coordinates in the redis.\n- We will also store whether drivers is online or not in the redis.\n\n- Driver matching worker will query this redis database with source coordinates and fetched nearby 10-20 drivers.\n- Then these drivers list is stored in the redis with rideId->drivers.\n\n- Driver matching service will iterate through the drivers and\n- fetch status of driver from redis (to know whether any request already sent to driver or driver in ride)\n- If driver is free then we send a notification to the driver about the ride\n  (websocket, server sent event or push notifications)\n- We also update driver status in redis to rideRequestSent so that other ride requests do not send same event to the driver.\n\n- If driver accepts the request then we update the ride status as well as driver status.\n- If the driver declines it then we move on to the other driver.\n\n- Meanwhile rider app will keep on polling the ride service and check whether any driver matched or not.\n","updated":1757006794198,"groupIds":[],"strokeStyle":"solid","seed":1764721627,"strokeWidth":2,"angle":0,"locked":false,"textAlign":"left","verticalAlign":"top","fontSize":20,"backgroundColor":"transparent","fontFamily":8,"width":1364,"strokeColor":"#1e1e1e","y":2361.699070484258,"index":"aN","id":"3Lvf5PMQT7JSvW47czNo6","version":2748,"isDeleted":false,"versionNonce":564536469,"height":1050,"autoResize":true,"roughness":1}],"type":"excalidraw","files":{},"version":2,"appState":{"viewBackgroundColor":"#ffffff"}}